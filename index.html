<!DOCTYPE html>
<html lang="en" class="ios ios-translucent-bars ios-translucent-modals device-pixel-ratio-2 device-ios ios dark">
<head>
  <meta charset="utf-8">
  <link rel="apple-touch-icon" href="favicon.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, viewport-fit=cover">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <title>TSChecker</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/framework7@8.3.3/framework7-bundle.min.css" integrity="sha256-cK8qB/ROffwYFEJ4KDE1DKIQqES7GT1/VmrZr+KWfqw=" crossorigin="anonymous">
</head>
<body>
  <div id="app">
    <div class="view view-main">
      <div data-name="home" class="page">
        <div class="navbar navbar-large navbar-transparent">
          <div class="navbar-bg"></div>
          <div class="navbar-inner sliding">
            <div class="title">TSChecker</div>
            <div class="title-large">
              <div class="title-large-text">TSChecker</div>
            </div>
          </div>
        </div>
        <div class="page-content">
          <div class="block-title">Version Type</div>
          <div class="block block-strong inset">
            <div class="segmented segmented-strong">
                <a id="releaseButton" class="button button-active" onclick="setVersionType('release')">Release</a> 
              <a id="betaButton" class="button" onclick="setVersionType('beta')">Beta</a>
              <span class="segmented-highlight"></span>
            </div>
          </div>
          <div class="block-title">Choose Device</div>
          <div class="list list-strong-ios list-dividers-ios inset-ios">
            <ul>
              <li>
                <a id="chooseDevice" class="list-button" onclick="openPicker()">Choose Device</a>
              </li>
              <li>
                <a onclick="checkSupport()" type="button" class="list-button">Check Support</a>
              </li>
            </ul>
          </div>
          <div class="block-title">Support Information</div>
          <div id="supportInfo" class="block block-strong inset">
            <p>iOS Version: Unknown</p>
            <p>Device: Unknown</p>
            <p style="color:red;">TrollStore Support: Unknown</p>
          </div>
          <div id="cfwButtonContainer" style="display: none;">
            <a href="https://ios.cfw.guide" target="_blank" class="button">Open iOS CFW Guide</a>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/framework7@8.3.3/framework7-bundle.min.js" integrity="sha256-1r9ib4mhGW3+qxoxb4nz2z4GkQqNG/CUa4Emli2pL2I=" crossorigin="anonymous"></script><script src="app.js"></script>
  <script>
    var selectedVersionType = 'release';
    var selectedDevice = null;
    var selectedArchitecture = 'arm64';
    var iosVersion = getIOSVersion();

    const deviceList = [
      {model: 'Unknown', architecture:'Unknown'}, 
      { model: 'iPhone 6s', architecture: 'arm64' },
      { model: 'iPhone 6s Plus', architecture: 'arm64' },
      { model: 'iPhone 7', architecture: 'arm64' },
      { model: 'iPhone 7 Plus', architecture: 'arm64' },
      { model: 'iPhone 8', architecture: 'arm64' },
      { model: 'iPhone 8 Plus', architecture: 'arm64' },
      { model: 'iPhone X', architecture: 'arm64e' },
      { model: 'iPhone XR', architecture: 'arm64e' },
      { model: 'iPhone XS', architecture: 'arm64e' },
      { model: 'iPhone XS Max', architecture: 'arm64e' },
      { model: 'iPhone 11', architecture: 'arm64e' },
      { model: 'iPhone 11 Pro', architecture: 'arm64e' },
      { model: 'iPhone 11 Pro Max', architecture: 'arm64e' },
      { model: 'iPhone 12 mini', architecture: 'arm64e' },
      { model: 'iPhone 12', architecture: 'arm64e' },
      { model: 'iPhone 12 Pro', architecture: 'arm64e' },
      { model: 'iPhone 12 Pro Max', architecture: 'arm64e' },
      { model: 'iPhone 13 mini', architecture: 'arm64e' },
      { model: 'iPhone 13', architecture: 'arm64e' },
      { model: 'iPhone 13 Pro', architecture: 'arm64e' },
      { model: 'iPhone 13 Pro Max', architecture: 'arm64e' },
      { model: 'iPhone 14', architecture: 'arm64e' },
      { model: 'iPhone 14 Plus', architecture: 'arm64e' },
      { model: 'iPhone 14 Pro', architecture: 'arm64e' },
      { model: 'iPhone 14 Pro Max', architecture: 'arm64e' }
    ];

    var pickerDevice = null;

    function getIOSVersion() {
      const userAgent = navigator.userAgent;
      const match = userAgent.match(/OS (\d+_\d+)/);
      return match ? match[1].replace('_', '.') : null; // Convert "14_0" to "14.0"
    }

    function getTrollStoreSupport(version, architecture) {
      if (!version) {
        return 'Unsupported';
      }

      // Convert the version string to a number for comparison
      const versionNumber = parseFloat(version);

      // Check if the version is unsupported
      if (versionNumber < 14 || versionNumber > 17.01) {
        return 'Unsupported';
      }

      const versionSupport = {
        '14.0': 'Unsupported',
        '14.1': 'TrollInstallerX',
        '14.2': 'TrollHelperOTA',
        '14.3': 'TrollHelperOTA',
        '14.4': 'TrollHelperOTA',
        '14.5': 'TrollHelperOTA',
        '14.6': 'TrollHelperOTA',
        '14.7': 'TrollHelperOTA',
        '14.8': 'TrollHelperOTA',
        '15.0': 'TrollHelperOTA',
        '15.1': 'TrollHelperOTA',
        '15.2': 'TrollHelperOTA',
        '15.3': 'TrollHelperOTA',
        '15.4': 'TrollHelperOTA',
        '15.5': 'TrollInstallerMDC, TrollInstallerX, TrollHelperOTA',
        '15.6': 'TrollInstallerMDC, TrollInstallerX, TrollHelperOTA',
        '15.7': 'TrollInstallerMDC, TrollInstallerX',
        '15.8': 'TrollMisaka, TrollInstallerX',
        '16.0': 'TrollInstallerX',
        '16.1': 'TrollInstallerX',
        '16.2': 'TrollInstallerX',
        '16.3': 'TrollInstallerX',
        '16.4': 'TrollInstallerX',
        '16.5': 'TrollInstallerX',
        '16.6': 'TrollInstallerX',
        '16.7': 'TrollInstallerX',
        '17.0': 'TrollInstallerX',
        '17.0.1': 'Unsupported'
      };

      const support = versionSupport[version];
      if (support) {
        return support.includes('Unsupported') ? 'Not Supported' : support;
      }

      return 'Unknown';
    }

    function openPicker() {
      if (pickerDevice) {
        pickerDevice.open();
        return;
      }

      pickerDevice = app.picker.create({
        inputEl: '#chooseDevice',
        cols: [
          {
            textAlign: 'center',
            values: deviceList.map(device => device.model)
          }
        ],
        on: {
          change: function (picker, value) {
            selectedDevice = deviceList.find(device => device.model === value[0]);
            selectedArchitecture = selectedDevice.architecture;
            document.getElementById('supportInfo').innerHTML = `<p>Device: ${selectedDevice.model}</p><p>Architecture: ${selectedArchitecture}</p><p>iOS Version: ${iosVersion}</p>`;
          }
        }
      });
    }

    function checkSupport() {
      if (!selectedDevice) {
        app.dialog.alert('Please select a device first.');
        return;
      }

      const supportMessage = getTrollStoreSupport(iosVersion, selectedArchitecture);
      const supportInfoElement = document.getElementById('supportInfo');
      const cfwButtonContainer = document.getElementById('cfwButtonContainer');
      let color;

      // Clear previous support message
      const existingMessage = supportInfoElement.querySelector('p:last-of-type');
      if (existingMessage) {
        existingMessage.remove();
      }

      if (supportMessage === 'Not Supported') {
        color = 'red';
        cfwButtonContainer.style.display = 'none';
      } else if (supportMessage === 'Unsupported') {
        color = 'red';
        cfwButtonContainer.style.display = 'none';
      } else {
        color = 'green';
        cfwButtonContainer.style.display = 'block';
      }

      supportInfoElement.innerHTML += `<p style="color:${color};">TrollStore Support: ${supportMessage}</p>`;
    }

    function setVersionType(type) {
      selectedVersionType = type;
      document.getElementById('betaButton').classList.toggle('button-active', type === 'beta');
      document.getElementById('releaseButton').classList.toggle('button-active', type === 'release');
    }
  </script>
</body>
</html>
